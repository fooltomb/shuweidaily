<!DOCTYPE html>
<html>
<head>
</head>
<body>
<h2>用户贡献查询</h2>

<form action="{% url 'dailyreport:users' %}" method="post">
	{% csrf_token %}
	<label>用户</label><select name="user">
		<option value=-1>全部</option>
		{% for u in user_list %}
		<option value={{u.id}}>{{u.name}}</option>
		{% endfor %}
	</select>
	<label>起始日期</label><input type="date" name="begin_date" max={{today|date:"Y-m-d"}}>
	<label>结束日期</label><input type="date" name="end_date" max={{today|date:"Y-m-d"}}>
	<input type="submit" value="查询">
</form>
{% for user in list %}
<table border="1">
	<tr>
		{% for project in user.0 %}
		<th>{{project}}</th>
		{% endfor %}
	</tr>
	<tr>
		{% for weight in user.1 %}
		<td>{{weight}}</td>
		{% endfor %}
	</tr>
</table>
<br>
{% endfor %}
{% if is_super %}
<p>你好，管理员</p>
<form id="add" action="{% url 'dailyreport:adduser' %}" method="post">
	{% csrf_token %}
	<select name="user">
		{% for u in user_list %}
		<option value={{u.id}}>{{u.name}}</option>
		{% endfor %}
	</select>
	<input type="button" value="重制密码" onclick='Adduser("reset")' >
	<input type="button" value="设为离职" onclick='Adduser("unactive")' >
	<br><br>
	<input type="hidden" name="option" >
	<input type="text" name="newuser">
	<input type="button" value="新员工" onclick='Adduser("addnew")' >
</form>
{% endif %}
<script>
function Adduser(hiddentext)
{
	
	var f=document.forms["add"];
	if (hiddentext=="addnew")
	{
		if (f["newuser"].value=="" || f["newuser"].value==null)
		{	
			alert("新员工姓名不能为空");
			return;
		}
	}
	f["option"].value=hiddentext;
	f.submit();
}
</script>
</body>
</html>

